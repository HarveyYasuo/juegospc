<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solicitud de Eliminación de Cuenta</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Light gray background */
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">
    <div class="bg-white p-8 rounded-lg shadow-xl max-w-md w-full text-center border border-gray-200">
        <h1 class="text-3xl font-bold text-gray-800 mb-4">Solicitud de Eliminación de Cuenta</h1>
        <p class="text-gray-600 mb-6">
            Si deseas eliminar tu cuenta y todos los datos asociados de nuestra aplicación, por favor, introduce la dirección de correo electrónico que utilizaste para iniciar sesión con Google.
        </p>

        <div class="mb-4">
            <label for="emailInput" class="block text-gray-700 text-sm font-semibold mb-2 text-left">
                Tu correo electrónico (usado con Google Sign-In)
            </label>
            <input
                type="email"
                id="emailInput"
                class="shadow-sm appearance-none border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200 ease-in-out"
                placeholder="tu.correo@ejemplo.com"
                required
            >
        </div>

        <button
            id="submitRequestBtn"
            class="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg focus:outline-none focus:shadow-outline transition duration-200 ease-in-out transform hover:scale-105 shadow-md"
        >
            Solicitar Eliminación de Cuenta
        </button>

        <div id="messageArea" class="mt-6 p-4 rounded-lg text-sm hidden" role="alert"></div>

        <div class="mt-8 text-left text-gray-700 text-sm p-4 bg-gray-50 rounded-lg border border-gray-200">
            <h2 class="text-lg font-semibold mb-2">Información sobre tus datos:</h2>
            <p class="mb-2">
                Nuestra aplicación solo recopila los datos básicos proporcionados por tu cuenta de Google al iniciar sesión a través de Firebase:
            </p>
            <ul class="list-disc list-inside ml-4 mb-2 text-gray-600">
                <li>Tu dirección de correo electrónico</li>
                <li>Tu nombre de perfil</li>
                <li>Tu ID de usuario único de Firebase (UID)</li>
            </ul>
            <p>
                Al solicitar la eliminación, nos comprometemos a eliminar estos datos de nuestros registros de Firebase Authentication y de cualquier otra base de datos asociada donde se almacenen datos vinculados a tu ID de usuario.
            </p>
            <p class="mt-3">
                Si tienes alguna pregunta o necesitas asistencia, por favor, contáctanos en <a href="mailto:harveyrivas66@gmail.com" class="text-blue-600 hover:underline">soporte@tudominio.com</a>.
            </p>
        </div>
    </div>

    <script type="module">
        // --- Firebase y Autenticación ---
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        // Aunque no usaremos signInWithPopup o signOut directamente en esta página,
        // mantenemos la importación de getAuth para consistencia con tu configuración.
        import { getAuth } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        // No necesitamos Realtime Database para esta página de solicitud,
        // pero la mantengo si planeas usarla para registrar solicitudes.
        import { getDatabase } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // Tu configuración de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDXqLCRY6OgcXTXsAR-TvnC4bIICjDndsw",
            authDomain: "todo-en-uno-e79c7.firebaseapp.com",
            projectId: "todo-en-uno-e79c7",
            storageBucket: "todo-en-uno-e79c7.appspot.com",
            messagingSenderId: "122399269850",
            appId: "1:122399269850:web:210049a35cc9abff9fd6e3",
            databaseURL: "https://todo-en-uno-e79c7-default-rtdb.firebaseio.com/"
        };

        // Inicializa Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getDatabase(app); // Puedes usar esto si quieres guardar las solicitudes en Realtime Database

        // Referencias a elementos del DOM
        const emailInput = document.getElementById('emailInput');
        const submitRequestBtn = document.getElementById('submitRequestBtn');
        const messageArea = document.getElementById('messageArea');

        // Función para mostrar mensajes al usuario
        function showMessage(message, type = 'info') {
            messageArea.textContent = message;
            messageArea.classList.remove('hidden', 'bg-green-100', 'text-green-800', 'bg-red-100', 'text-red-800', 'bg-blue-100', 'text-blue-800');
            if (type === 'success') {
                messageArea.classList.add('bg-green-100', 'text-green-800');
            } else if (type === 'error') {
                messageArea.classList.add('bg-red-100', 'text-red-800');
            } else {
                messageArea.classList.add('bg-blue-100', 'text-blue-800');
            }
        }

        // Event listener para el botón de solicitud
        submitRequestBtn.addEventListener('click', async () => {
            const email = emailInput.value.trim();

            if (!email) {
                showMessage('Por favor, introduce tu dirección de correo electrónico.', 'error');
                return;
            }

            // Validación básica de email
            if (!/\S+@\S+\.\S+/.test(email)) {
                showMessage('Por favor, introduce una dirección de correo electrónico válida.', 'error');
                return;
            }

            showMessage('Enviando tu solicitud...', 'info');
            submitRequestBtn.disabled = true;

            try {
                // Aquí es donde normalmente enviarías la solicitud a tu backend.
                // Como no puedo crear un backend para ti directamente,
                // simularemos el envío y mostraremos un mensaje de éxito.

                // En un entorno real, harías algo como:
                // await fetch('/api/request-account-deletion', {
                //     method: 'POST',
                //     headers: { 'Content-Type': 'application/json' },
                //     body: JSON.stringify({ email: email })
                // });
                // O si usas Cloud Functions:
                // const response = await fetch('TU_URL_CLOUD_FUNCTION_DE_ELIMINACION', {
                //     method: 'POST',
                //     headers: { 'Content-Type': 'application/json' },
                //     body: JSON.stringify({ email: email })
                // });
                // const result = await response.json();
                // if (result.success) { ... } else { ... }

                // Simulación de una llamada a la API (retraso para mostrar el mensaje de "enviando")
                await new Promise(resolve => setTimeout(resolve, 2000));

                showMessage(
                    `Tu solicitud de eliminación de cuenta para ${email} ha sido recibida. Nos pondremos en contacto contigo pronto para confirmar el proceso.`,
                    'success'
                );
                emailInput.value = ''; // Limpiar el campo
            } catch (error) {
                console.error('Error al enviar la solicitud:', error);
                showMessage(
                    'Hubo un error al procesar tu solicitud. Por favor, inténtalo de nuevo o contáctanos directamente.',
                    'error'
                );
            } finally {
                submitRequestBtn.disabled = false;
            }
        });
    </script>
</body>
</html>
